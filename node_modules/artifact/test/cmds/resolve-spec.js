var chai = require('chai'),
    sinon = require("sinon"),
    sinonChai = require("sinon-chai"),
    expect = chai.expect;

var artifact, endpoint;

describe('lib/cmds/resolve.js', function() {

    before(function() {
        artifact = require('../../lib/artifact');
        endpoint = require('../../lib/endpoint');
        chai.use(sinonChai);
    });

    after(function() {
        endpoint.get.restore();
    });

    it('Registers resolve task to artifact', function() {
        expect(artifact.cmds).to.have.property('resolve');
    });

    it('Calls endpoint.get() when resolve is invoked', function() {
        var spy = sinon.spy(endpoint, 'get');
        var argument1 = {
            name: 'test',
            version: 'test'
        };
        var argument2 = {
            type: 'resolved'
        };
        artifact.cmds.resolve(argument1);
        expect(spy).to.have.been.calledWithExactly(["test", "test"], argument2);
    });

});